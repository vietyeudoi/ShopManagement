@using Sieu_Thi_Mini.Models
@model IEnumerable<Product>

@{
    Layout = "_LayoutAdmin";
    ViewData["Title"] = "Quản lý sản phẩm";
}

<div class="container-fluid">

    <!-- HEADER -->
    <div class="d-flex justify-content-between align-items-center mb-4">
        <div>
            <h3 class="fw-bold mb-0">📦 Quản lý sản phẩm</h3>
            <small class="text-muted">Danh sách toàn bộ sản phẩm trong hệ thống</small>
        </div>

        <a asp-area="Admin"
           asp-controller="Product"
           asp-action="Create"
           class="btn btn-primary shadow-sm">
            <i class="bi bi-plus-circle me-1"></i> Thêm sản phẩm
        </a>
    </div>

    <!-- CARD -->
    <div class="card shadow-sm border-0">
        <div class="card-body p-0">

            <table class="table table-hover align-middle mb-0">
                <thead class="table-light text-center">
                    <tr>
                        <th style="width:80px">Ảnh</th>
                        <th>Tên sản phẩm</th>
                        <th>Danh mục</th>
                        <th>Giá</th>
                        <th>Kho</th>
                        <th>Trạng thái</th>
                        <th style="width:220px">Hành động</th>
                    </tr>
                </thead>

                <tbody>
                @foreach (var item in Model)
                {
                    <tr>
                        <!-- IMAGE -->
                        <td class="text-center">
                            @if (!string.IsNullOrEmpty(item.ImageUrl))
                            {
                                    <img src="~/upload/@item.ImageUrl"
                                     class="rounded border"
                                     width="60" height="60"
                                     style="object-fit:cover" />
                            }
                            else
                            {
                                <img src="~/images/no-image.png"
                                     class="rounded border"
                                     width="60" height="60" />
                            }
                        </td>

                        <!-- NAME -->
                        <td>
                            <div class="fw-semibold">@item.ProductName</div>
                            <small class="text-muted">ID: @item.ProductId</small>
                        </td>

                        <!-- CATEGORY -->
                        <td>@item.Category?.CategoryName</td>

                        <!-- PRICE -->
                        <td class="text-danger fw-bold">
                            @item.Price.ToString("N0") ₫
                        </td>

                        <!-- STOCK -->
                        <td>
                            @if (item.Stock > 0)
                            {
                                <span class="badge bg-success">@item.Stock</span>
                            }
                            else
                            {
                                <span class="badge bg-danger">Hết hàng</span>
                            }
                        </td>

                        <!-- STATUS -->
                        <td class="text-center">
                            @if (item.IsActive)
                            {
                                <span class="badge bg-success">Đang bán</span>
                            }
                            else
                            {
                                <span class="badge bg-secondary">Ngừng bán</span>
                            }
                        </td>

                        <!-- ACTIONS -->
                        <td class="text-center">
                            <a asp-area="Admin"
                               asp-controller="Product"
                               asp-action="Edit"
                               asp-route-id="@item.ProductId"
                               class="btn btn-sm btn-warning me-1">
                                <i class="bi bi-pencil-square"></i> Sửa
                            </a>

                            <a asp-area="Admin"
                               asp-controller="Product"
                               asp-action="Toggle"
                               asp-route-id="@item.ProductId"
                               class="btn btn-sm @(item.IsActive ? "btn-outline-secondary" : "btn-outline-success") me-1">
                                <i class="bi @(item.IsActive ? "bi-eye-slash" : "bi-eye")"></i>
                                @(item.IsActive ? "Ẩn" : "Hiện")
                            </a>

                            <a asp-area="Admin"
                               asp-controller="Product"
                               asp-action="Delete"
                               asp-route-id="@item.ProductId"
                               class="btn btn-sm btn-danger">
                                <i class="bi bi-trash"></i> Xoá
                            </a>
                        </td>
                    </tr>
                }
                </tbody>
            </table>

        </div>
    </div>
</div>
