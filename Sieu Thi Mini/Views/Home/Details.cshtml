@model Sieu_Thi_Mini.Models.Product
@{
    ViewData["Title"] = Model.ProductName;
    Layout = ViewData["Layout"]?.ToString() ?? "_Layout";
    var related = ViewBag.RelatedProducts as List<Sieu_Thi_Mini.Models.Product>;
}
<div class="row mb-5">
    <div class="col-md-5">
        <img src="~/upload/@Model.ImageUrl"
             class="img-fluid rounded shadow-sm"
             style="width:100%; object-fit:cover" />
    </div>

    <div class="col-md-7">
        <h3 class="fw-bold">@Model.ProductName</h3>

        <p class="text-muted">
            Danh mục: <strong>@Model.Category?.CategoryName</strong>
        </p>

        <h4 class="text-danger fw-bold">
            @Model.Price.ToString("N0") đ
        </h4>

        <p class="mt-3">
            @Model.Description
        </p>

        <!-- THÊM VÀO GIỎ -->
        <form asp-area="Customer"
              asp-controller="Cart"
              asp-action="Add"
              method="post"
              class="mt-4">
            <input type="hidden" name="id" value="@Model.ProductId" />
            <button class="btn btn-danger btn-lg">
                <i class="bi bi-cart-plus"></i> Thêm vào giỏ
            </button>
        </form>
    </div>
</div>
@if (related != null && related.Any())
{
    <h4 class="mb-3">Sản phẩm tương tự</h4>

    <div class="row">
        @foreach (var p in related)
        {
            <div class="col-md-3 mb-3">
                <div class="card h-100 shadow-sm">

                    <a asp-controller="Product"
                       asp-action="Details"
                       asp-route-id="@p.ProductId">
                        <img src="~/upload/@p.ImageUrl"
                             class="card-img-top"
                             style="height:160px; object-fit:cover" />
                    </a>

                    <div class="card-body text-center">
                        <h6 class="card-title">@p.ProductName</h6>

                        <p class="text-danger fw-bold">
                            @p.Price.ToString("N0") đ
                        </p>

                        <form asp-area="Customer"
                              asp-controller="Cart"
                              asp-action="Add"
                              method="post">
                            <input type="hidden" name="id" value="@p.ProductId" />
                            <button class="btn btn-sm btn-outline-danger w-100">
                                Thêm vào giỏ
                            </button>
                        </form>
                    </div>
                </div>
            </div>
        }
    </div>
}
